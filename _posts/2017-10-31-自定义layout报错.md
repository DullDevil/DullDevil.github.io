---
title: 自定义layout报错
categories: [使用技巧]
---

错误如下：

```
Logging only once for UICollectionViewFlowLayout cache mismatched frame
This is likely occurring because the flow layout subclass ***  is modifying attributes returned by UICollectionViewFlowLayout without copying them
```

既然错误原因是没copy 那就 copy 一下


解决：

```
- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect {
    NSMutableArray *allAttributesInArray = [NSMutableArray array];

    NSArray *attribs = [super layoutAttributesForElementsInRect:rect];
    for (UICollectionViewLayoutAttributes *attributes in attribs) {
        if (CGRectIntersectsRect(attributes.frame, rect)) {
            UICollectionViewLayoutAttributes* attributesCopy = [attributes copy];
            attributesCopy.bounds = CGRectMake(0, 0, CGRectGetWidth(attributes.bounds)/2.0, CGRectGetHeight(attributes.bounds) * 0.8);
            [allAttributesInArray addObject:attributesCopy];
        }
    }

    return allAttributesInArray;
}
```
